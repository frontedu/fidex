# Configuração do servidor (Render deployment)
server.port=${PORT:8080}
server.address=0.0.0.0

# Startup optimization
spring.main.lazy-initialization=false
spring.jmx.enabled=false

# Expoe os endpoints dos actuators health e info
management.endpoints.web.exposure.include=health,info
management.info.env.enabled=true
info.app.name=FIDEX
info.app.description=O jeito descomplicado de recompensar seus clientes.
info.app.version=2.0.0

# Redução de Log
logging.level.root=WARN
logging.level.org.flywaydb.core.internal.database.base.Database=ERROR

#Colorir o log
spring.output.ansi.enabled=always

# Configuracoes de Locale
spring.web.locale-resolver=fixed
spring.web.locale=pt_BR
localdate.format-pt_BR=dd/MM/yyyy

# Configuracoes do BD (via variáveis de ambiente)
spring.datasource.url=${DATABASE_URL}
spring.datasource.username=${DATABASE_USERNAME}
spring.datasource.password=${DATABASE_PASSWORD}

# Configurações do HikariCP (pool de conexões otimizado)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.connection-timeout=10000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

#Configuracoes do Hibernate
# Para o Hibernate mostrar o SQL Formatado
spring.jpa.properties.hibernate.format_sql=true

# Batching optimization
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Para que o Spring nao use o seu padrao de nomes de colunas e sim o do Hibernate nas entidades
spring.jpa.hibernate.naming.implicit-strategy=org.hibernate.boot.model.naming.ImplicitNamingStrategyLegacyJpaImpl
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

# Para evitar que o Thymeleaf acesse o BD usando JPA durante o processamento da view
spring.jpa.open-in-view=false

#Habilitar cache no Thymeleaf
spring.thymeleaf.cache=true

# Spring Boot 3 Modernization
spring.threads.virtual.enabled=true