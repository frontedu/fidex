<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="FIDEX - Sistema de fidelização de clientes. Gerencie pontos, prêmios e recompense seus clientes.">
    <meta name="robots" content="noindex, nofollow">
    <title layout:title-pattern="$CONTENT_TITLE | $LAYOUT_TITLE">Fidex</title>
    <link rel="shortcut icon" th:href="@{/images/favicon.ico}" />
    <link rel="manifest" th:href="@{/manifest.json}" />
    <meta name="theme-color" content="#e3ffa8" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" type="text/css" href="../static/css/fidex.css" th:href="@{/css/fidex.css?v=28}">
    <script defer th:src="@{/js/progress.js}" src="../static/js/progress.js"></script>
</head>

<body>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container">
        <div th:if="${sucesso}" class="toast toast-success" id="toast-success">
            <span th:text="${sucesso}"></span>
        </div>
        <div th:if="${erro}" class="toast toast-error" id="toast-error">
            <span th:text="${erro}"></span>
        </div>
    </div>

    <!-- Conteudo Principal -->
    <div class="col" layout:fragment="main-content"></div>

    <!-- Mobile Components -->
    <!-- Mobile Components -->
    <div th:replace="~{layout/fragments/mobile_nav :: mobile-nav}"></div>

    <script>
        const inputs = document.querySelectorAll(".input-group input");

        // Function to check and update input state
        const updateInputState = (input) => {
            if (input.value) {
                input.classList.add("filled");
            } else {
                input.classList.remove("filled");
            }
        };

        inputs.forEach((input) => {
            // Check immediately on load
            updateInputState(input);

            // Listen for changes
            input.addEventListener("change", () => updateInputState(input));
            input.addEventListener("input", () => updateInputState(input));
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const formSubmitButton = document.querySelector('.form input[type="submit"]');
            if (formSubmitButton) {
                formSubmitButton.style.backgroundColor = "var(--load)";
            }

            // Ensure modal checkbox is unchecked on load
            const modalToggle = document.getElementById('modal-toggle-user');
            if (modalToggle) {
                modalToggle.checked = false;
            }
        });
    </script>
    <script>
        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(reg => console.log('SW registered'))
                .catch(err => console.log('SW registration failed'));
        }
    </script>
</body>

</html>